<!-- =======================
Page banner START -->
<section class="py-0">
    <div class="container">
        <!-- Card START -->
        <div class="card bg-light overflow-hidden px-sm-5">
            <div class="row align-items-center g-4">

                <!-- Content -->
                <div class="col-sm-9">
                    <div class="card-body">
                        <!-- Breadcrumb -->
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb breadcrumb-dots mb-0">
                                <li class="breadcrumb-item"><a routerLink="/"><i class="bi bi-house me-1"></i> Home</a>
                                </li>
                                <li class="breadcrumb-item">Hotel detail</li>
                                <li class="breadcrumb-item active">Booking</li>
                            </ol>
                        </nav>
                        <!-- Title -->
                        <h1 class="m-0 h2 card-title">Review your Booking</h1>
                    </div>
                </div>

                <!-- Image -->
                <div class="col-sm-3 text-end d-none d-sm-block">
                    <img src="./assets/BookingImages/17.svg" class="mb-n4" alt="">
                </div>
            </div>
        </div>
        <!-- Card END -->
    </div>
</section>
<!-- =======================
Page banner END -->

<!-- =======================
Page content START -->
<section>
    <div class="container">
        <div class="row g-4 g-lg-5">

            <!-- Left side content START -->
            <div class="col-xl-8">
                <div class="vstack gap-5">
                    <!-- Hotel information START -->
                    <div class="card shadow">
                        <!-- Card header -->
                        <div class="card-header p-4 border-bottom">
                            <!-- Title -->
                            <h3 class="mb-0"><i class="fa-solid fa-hotel me-2"></i>Hotel Information</h3>
                        </div>

                        <!-- Card body START -->
                        <div class="card-body p-4">
                            <!-- Card list START -->
                            <div class="card mb-4">
                                <div class="row align-items-center">
                                    <!-- Image -->
                                    <div class="col-sm-6 col-md-4">
                                        <img src="{{room?.hotel.hotelImages[0]?.imageUrl}}" class="card-img"
                                            alt="HotelImage">
                                    </div>

                                    <!-- Card Body -->
                                    <div class="col-sm-6 col-md-8">
                                        <div class="card-body pt-3 pt-sm-0 p-0">
                                            <!-- Title -->
                                            <h5 class="card-title"><a
                                                    routerLink="hoteldetail/{{room?.hotelId}}">{{room?.hotel.name}}</a>
                                            </h5>
                                            <p class="small mb-2"><i
                                                    class="bi bi-geo-alt me-2"></i>{{room?.hotel.location}}</p>

                                            <!-- Rating star -->
                                            <app-rating-stars [reviewCount]="avgRating"
                                                [starSize]="20"></app-rating-stars>
                                            <ul class="list-inline mb-0">
                                                <li class="list-inline-item ms-2 h6 small fw-bold mb-0">{{avgRating}}
                                                    out of 5.0</li>
                                            </ul>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <!-- Card list END -->
                            <div class="container mt-5">
                                <form>
                                    <div class="row g-4">
                                        <!-- Date Range -->
                                        <div class="col-lg-6">
                                            <div
                                                class="form-control-border form-control form-fs-md d-flex bg-light py-3 px-4 rounded-3">
                                                <!-- Icon -->
                                                <i class="bi bi-calendar fs-3 me-2 mt-2"></i>
                                                <!-- Date input -->
                                                <div class="w-100">
                                                    <label class="form-label fw-light small mb-1">Check-in and Check-out
                                                        Date</label>
                                                    <input type="text" name="selectedDate"
                                                        class="form-control flatpickr" bsDaterangepicker
                                                        [(ngModel)]="selectedDates"
                                                        [bsConfig]="{ isAnimated: true, containerClass: 'theme-dark-blue', dateInputFormat: 'YYYY-MM-DD', minDate: minDate }"
                                                        required>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Guest -->
                                        <div class="col-lg-6">
                                            <div
                                                class="form-control-border form-control form-fs-md d-flex bg-light py-3 px-4 rounded-3">
                                                <!-- Icon -->
                                                <i class="bi bi-person fs-3 me-2 mt-2"></i>
                                                <!-- Dropdown input -->
                                                <div class="w-100">
                                                    <label class="form-label fw-light small mb-1">Guests & Rooms</label>
                                                    <div class="dropdown guest-selector me-2">
                                                        <input type="text"
                                                            class="form-guest-selector form-control selection-result"
                                                            value="{{numberOfAdults + numberOfChildren}} Guests & {{numberOfRooms}} Room"
                                                            id="dropdownGuest" data-bs-auto-close="outside"
                                                            data-bs-toggle="dropdown" />
                                                        <!-- dropdown items -->
                                                        <ul class="dropdown-menu guest-selector-dropdown"
                                                            aria-labelledby="dropdownGuest">
                                                            <!-- Adult -->
                                                            <li class="d-flex justify-content-between">
                                                                <div>
                                                                    <h6 class="mb-0">Adults</h6>
                                                                    <small>Ages 14 or above</small>
                                                                </div>
                                                                <div class="hstack gap-1 align-items-center">
                                                                    <button (click)="addAdult(false)" type="button"
                                                                        class="btn btn-link adult-remove p-0 mb-0">
                                                                        <i class="bi bi-dash-circle fs-5 fa-fw"></i>
                                                                    </button>
                                                                    <h6 class="guest-selector-count mb-0 adults">
                                                                        {{numberOfAdults}}</h6>
                                                                    <button (click)="addAdult(true)" type="button"
                                                                        class="btn btn-link adult-add p-0 mb-0">
                                                                        <i class="bi bi-plus-circle fs-5 fa-fw"></i>
                                                                    </button>
                                                                </div>
                                                            </li>
                                                            <!-- Divider -->
                                                            <li class="dropdown-divider"></li>
                                                            <!-- Child -->
                                                            <li class="d-flex justify-content-between">
                                                                <div>
                                                                    <h6 class="mb-0">Child</h6>
                                                                    <small>Ages 14 below</small>
                                                                </div>
                                                                <div class="hstack gap-1 align-items-center">
                                                                    <button (click)="noOfChildren(false)" type="button"
                                                                        class="btn btn-link child-remove p-0 mb-0">
                                                                        <i class="bi bi-dash-circle fs-5 fa-fw"></i>
                                                                    </button>
                                                                    <h6 class="guest-selector-count mb-0 child">
                                                                        {{numberOfChildren}}</h6>
                                                                    <button (click)="noOfChildren(true)" type="button"
                                                                        class="btn btn-link child-add p-0 mb-0">
                                                                        <i class="bi bi-plus-circle fs-5 fa-fw"></i>
                                                                    </button>
                                                                </div>
                                                            </li>
                                                            <!-- Divider -->
                                                            <li class="dropdown-divider"></li>
                                                            <!-- Rooms -->
                                                            <li class="d-flex justify-content-between">
                                                                <div>
                                                                    <h6 class="mb-0">Rooms</h6>
                                                                    <small>Max room 10</small>
                                                                </div>
                                                                <div class="hstack gap-1 align-items-center">
                                                                    <button (click)="noOfRooms(false)" type="button"
                                                                        class="btn btn-link room-remove p-0 mb-0">
                                                                        <i class="bi bi-dash-circle fs-5 fa-fw"></i>
                                                                    </button>
                                                                    <h6 class="guest-selector-count mb-0 rooms">
                                                                        {{numberOfRooms}}</h6>
                                                                    <button (click)="noOfRooms(true)" type="button"
                                                                        class="btn btn-link room-add p-0 mb-0">
                                                                        <i class="bi bi-plus-circle fs-5 fa-fw"></i>
                                                                    </button>
                                                                </div>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </form>
                            </div>



                            <!-- Card START -->
                            <div class="card border mt-4">
                                <!-- Card header -->
                                <div class="card-header border-bottom d-md-flex justify-content-md-between">
                                    <h5 class="card-title mb-0">{{room?.roomType}} Room with {{room?.bedType}} BedType</h5>
                                    
                                </div>

                                <!-- Card body -->
                                <div class="card-body">

                                    <!-- Information START -->
                                    <div class="row g-4 mb-3">
                                        <!-- Item -->
                                        <div class="col-lg-4">
                                            <div class="bg-light py-3 px-4 rounded-3">
                                                <h6 class="fw-light small mb-1">Check-in</h6>
                                                <h5 class="mb-1">{{selectedDates[0] |date:'d MMMM y'}}</h5>
                                                <small><i class="bi bi-alarm me-1"></i>11:30 pm</small>
                                            </div>
                                        </div>

                                        <!-- Item -->
                                        <div class="col-lg-4">
                                            <div class="bg-light py-3 px-4 rounded-3">
                                                <h6 class="fw-light small mb-1">Check out</h6>
                                                <h5 class="mb-1">{{selectedDates[1] |date:'d MMMM y'}}</h5>
                                                <small><i class="bi bi-alarm me-1"></i>6:30 pm</small>
                                            </div>
                                        </div>

                                        <!-- Item -->
                                        <div class="col-lg-4">
                                            <div class="bg-light py-3 px-4 rounded-3">
                                                <h6 class="fw-light small mb-1">Rooms & Guests</h6>
                                                <h5 class="mb-1">{{numberOfAdults+numberOfChildren}} G - {{numberOfRooms}} R</h5>
                                                <small><i class="bi bi-brightness-high me-1"></i>{{calculateDuration(selectedDates[0],selectedDates[1])}}</small>
                                            </div>
                                        </div>
                                    </div>
                                    <ul class="nav small nav-divider mb-2">
                                        <li class="nav-item mb-0">
                                            <i class="fa-regular fa-square me-1"></i>{{room?.roomSize}}
                                        </li>
                                        <li class="nav-item mb-0">
                                            <i class="fa-solid fa-table-cells-large me-1"></i>City view
                                        </li>
                                        <li class="nav-item mb-0">
                                            <i class="fa-solid fa-bed me-1"></i>{{room?.bedType}} Bed
                                        </li>
                                        <li class="nav-item mb-0">
                                            <i class="fa-solid fa-person me-1"></i>{{room?.maxOccupancy}} persons Occupancy
                                        </li>
                                    </ul>
                                    
                                    <!-- Information END -->
                                    
                                    
                                    <h6>Price Included</h6>
                                    <!-- List -->
                                    <ul class="list-group list-group-borderless mb-0">
                                        <li class="list-group-item h6 fw-light d-flex mb-0"><i
                                                class="bi bi-patch-check-fill text-success me-2"></i>Free Breakfast and
                                            Lunch/Dinner.</li>
                                        <li class="list-group-item h6 fw-light d-flex mb-0"><i
                                                class="bi bi-patch-check-fill text-success me-2"></i>Great Small Breaks.
                                        </li>
                                        <li class="list-group-item h6 fw-light d-flex mb-0"><i
                                                class="bi bi-patch-check-fill text-success me-2"></i>Free Stay for Kids
                                            Below the age of 5 years.</li>
                                        
                                    </ul>
                                </div>
                            </div>
                            <!-- Card END -->
                        </div>
                        <!-- Card body END -->
                    </div>
                    <!-- Hotel information END -->

                    <!-- Guest detail START -->
                    <div class="card shadow">
                        <!-- Card header -->
                        <div class="card-header border-bottom p-4">
                          <h4 class="card-title mb-0"><i class="bi bi-people-fill me-2"></i>Guest Details</h4>
                        </div>
                      
                        <!-- Card body START -->
                        <div class="card-body p-4">
                          <!-- Form START -->
                          <form [formGroup]="guestForm">
                            <!-- Main Guest -->
                            <div class="row g-4">
                              <!-- Title -->
                              <div class="col-md-2">
                                <div class="form-size-lg">
                                  <label class="form-label">Title</label>
                                  <select class="form-select js-choice" formControlName="title">
                                    <option value="Mr">Mr</option>
                                    <option value="Mrs">Mrs</option>
                                  </select>
                                </div>
                              </div>
                      
                              <!-- Input - First Name -->
                              <div class="col-md-5">
                                <label class="form-label">First Name</label>
                                <input type="text" class="form-control form-control-lg" formControlName="firstName" placeholder="Enter your first name">
                              </div>
                      
                              <!-- Input - Last Name -->
                              <div class="col-md-5">
                                <label class="form-label">Last Name</label>
                                <input type="text" class="form-control form-control-lg" formControlName="lastName" placeholder="Enter your last name">
                              </div>
                            </div>
                      
                          </form>
                          <!-- Form END -->
                      
                          <!-- Additional Guest Forms -->
                          <div *ngFor="let guest of guests; let i = index">
                            <form [formGroup]="guest">
                              <div class="row g-4 mt-3">
                                <div class="col-md-2">
                                  <div class="form-size-lg">
                                    <label class="form-label">Title</label>
                                    <select class="form-select js-choice" formControlName="title">
                                      <option value="Mr">Mr</option>
                                      <option value="Mrs">Mrs</option>
                                    </select>
                                  </div>
                                </div>
                                <div class="col-md-5">
                                  <label class="form-label">First Name</label>
                                  <input type="text" class="form-control form-control-lg" formControlName="firstName" placeholder="Enter guest's first name">
                                </div>
                                <div class="col-md-5">
                                  <label class="form-label">Last Name</label>
                                  <input type="text" class="form-control form-control-lg" formControlName="lastName" placeholder="Enter guest's last name">
                                </div>
                                <div class="col-12 mt-2">
                                  <button type="button" class="btn btn-danger" (click)="removeGuest(i)">Remove</button>
                                </div>
                              </div>
                            </form>
                          </div>
                          <!-- Additional Guest Forms END -->
                      
                          <!-- ADD Button -->
                          <div class="mt-3">
                            <button type="button" class="btn btn-primary" (click)="addNewGuest()"><i class="fa-solid fa-plus me-2"></i>Add New Guest</button>
                          </div>
                          
                        <!-- Email and Mobile Number Inputs -->
                            <div class="row mt-3">
                                <!-- Input - Email -->
                                <div class="col-md-6">
                                    <label class="form-label">Email id</label>
                                    <input type="email" class="form-control form-control-lg" placeholder="Enter your email" value="{{user.email}}">
                                    
                                </div>

                                <!-- Input - Mobile Number -->
                                <div class="col-md-6">
                                    <label class="form-label">Mobile number</label>
                                    <input type="text" class="form-control form-control-lg" placeholder="Enter your mobile number" value="{{user.contactNumber}}">
                                </div>
                            </div>
                        </div>
                        <!-- Card body END -->
                      </div>
                      
                    <!-- Guest detail END -->

                </div>
            </div>
            <!-- Left side content END -->

            <!-- Right side content START -->
            <aside class="col-xl-4">
                <div class="row g-4">

                    <!-- Price summary START -->
                    <div class="col-md-6 col-xl-12">
                        <div class="card shadow rounded-2">
                            <!-- card header -->
                            <div class="card-header border-bottom">
                                <h5 class="card-title mb-0">Price Summary</h5>
                            </div>

                            <!-- Card body -->
                            <div class="card-body">
                                <ul class="list-group list-group-borderless">
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <span class="h6 fw-light mb-0">Room Charges</span>
                                        <span class="fs-5">₹ {{ calculateRoomCharges() }}</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <span class="h6 fw-light mb-0">Total Discount<span
                                                class="badge text-bg-danger smaller mb-0 ms-2">{{ priceData.discountPercentage }}% off</span></span>
                                        <span class="fs-5 text-success">- ₹ {{ calculateDiscountAmount() }}</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <span class="h6 fw-light mb-0">Price after discount</span>
                                        <span class="fs-5">₹ {{ calculatePriceAfterDiscount() }}</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <span class="h6 fw-light mb-0">Additional Charges</span>
                                        <small style="margin-left: -10%;" class="mb-0 s-2">Extra Guests</small>
                                        <span class="fs-5">₹ {{ calculateAdditionalCharges() }}</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <span class="h6 fw-light mb-0">Taxes & Fees</span>
                                        <!-- Placeholder for taxes and fees -->
                                        <span class="fs-5">₹ {{priceData.taxesAndFees}}</span>
                                    </li>
                                    
                                </ul>
                            </div>

                            <!-- Card footer -->
                            <div class="card-footer border-top">
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="h5 mb-0">Payable Now</span>
                                    <span class="h5 mb-0">₹ {{ calculatePayableNow() }}</span>
                                </div>
                                 <!-- Booked Button -->
                                 <div class="mt-3 hstack gap-4 flex-wrap align-items-center">
                                    <button *ngIf="user?.role === 'User'" type="button" style="width: 100%; font-size: 100%;" class="btn btn-success-soft mb-0"  data-toggle="modal" data-target="#myModal" (click)="BookNow()">Book Now</button>
                                  </div>
                                  
                            </div>
                        </div>
                    </div>
                    <!-- Price summary END -->

                </div>
            </aside>
            <!-- Right side content END -->
        </div> <!-- Row END -->
    </div>
</section>
<!-- =======================
Page content END -->

<!-- The Modal -->
<div class="modal" id="myModal" *ngIf="user?.role === 'User'">
    <div class="modal-dialog">
      <div class="modal-content">
  
        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title">Payment</h4>
          <button type="button" class="close" data-dismiss="modal" (click)="PayLater()">&times;</button>
        </div>
  
        <!-- Modal body -->
        <div class="modal-body">
            <div class="d-flex justify-content-between align-items-center">
                <span class="h5 mb-0">Total Amount</span>
                <span class="h5 mb-0">₹ {{ calculatePayableNow() }}</span>
            </div>
        </div>
  
        <!-- Modal footer -->
        <div class="modal-footer">
            <button type="button" class="btn btn-success mb-0" data-dismiss="modal" (click)="PayNow()">Pay Now</button>
        
            <button type="button" class="btn btn-danger-soft mb-0" data-dismiss="modal" (click)="PayLater()">Pay Later</button>
          
        </div>
        
        
      </div>
    </div>
  </div>

  

